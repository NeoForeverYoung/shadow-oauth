# Casdoor 项目学习里程碑计划

> **目标用户**：3年开发经验程序员  
> **总预计时间**：3-4周（每天6小时）  
> **最后更新**：2025-10-20

---

## 📊 学习进度概览

- [ ] 里程碑 1：环境搭建与项目运行（2天）
- [ ] 里程碑 2：理解核心数据模型（3天）
- [ ] 里程碑 3：掌握用户认证流程（4天）
- [ ] 里程碑 4：OAuth2/OIDC 协议实践（4天）
- [ ] 里程碑 5：权限系统（Casbin）（3天）
- [ ] 里程碑 6：第三方登录集成（3天）
- [ ] 里程碑 7：前端架构学习（3天）
- [ ] 里程碑 8：高级功能模块（4天）
- [ ] 里程碑 9：实战项目开发（5天）

---

## 🎯 里程碑 1：环境搭建与项目运行

**目标**：成功在本地运行 Casdoor 前后端，并能访问管理界面

**时间**：2天

### 任务清单

#### Day 1：后端环境搭建
- [ ] 安装 Go 1.21+ 环境
  ```bash
  go version  # 验证版本
  ```
- [ ] 安装 MySQL 数据库
  ```bash
  mysql -V  # 验证安装
  ```
- [ ] 配置数据库
  ```sql
  CREATE DATABASE casdoor;
  CREATE USER 'casdoor'@'localhost' IDENTIFIED BY 'casdoor123';
  GRANT ALL PRIVILEGES ON casdoor.* TO 'casdoor'@'localhost';
  FLUSH PRIVILEGES;
  ```
- [ ] 修改配置文件 `conf/app.conf`
  ```ini
  dataSourceName = casdoor:casdoor123@tcp(localhost:3306)/
  dbName = casdoor
  ```
- [ ] 安装 Go 依赖
  ```bash
  go mod download
  go mod tidy
  ```
- [ ] 启动后端服务
  ```bash
  go run main.go
  ```
- [ ] 验证启动成功：访问 http://localhost:8000

#### Day 2：前端环境搭建
- [ ] 安装 Node.js 16+ 和 npm/yarn
  ```bash
  node -v
  npm -v
  ```
- [ ] 进入前端目录并安装依赖
  ```bash
  cd web
  npm install
  ```
- [ ] 启动前端开发服务器
  ```bash
  npm start
  ```
- [ ] 访问前端：http://localhost:7001
- [ ] 使用默认账号登录：`admin` / `123`
- [ ] 浏览所有主要管理页面
  - 组织管理
  - 用户管理
  - 应用管理
  - 提供商管理

### 验收标准 ✅

1. ✅ 后端服务正常启动，无错误日志
2. ✅ 数据库表自动创建成功（至少20+张表）
3. ✅ 前端页面正常加载，无 Console 错误
4. ✅ 能够使用 admin 账号登录系统
5. ✅ 能够在界面上创建一个新用户
6. ✅ 能够看到 Swagger API 文档：http://localhost:8000/swagger

### 学习笔记模板
```markdown
## 我的环境配置
- 操作系统：
- Go 版本：
- Node 版本：
- 数据库版本：

## 遇到的问题
1. 问题描述：
   解决方案：

## 关键发现
- 
```

---

## 🎯 里程碑 2：理解核心数据模型

**目标**：掌握 Casdoor 的核心数据结构和表关系

**时间**：3天

### 任务清单

#### Day 1：数据模型分析
- [ ] 阅读并理解以下核心模型代码
  - [ ] `object/user.go` - User 结构体定义（重点关注字段含义）
  - [ ] `object/organization.go` - Organization 结构体
  - [ ] `object/application.go` - Application 结构体
  - [ ] `object/provider.go` - Provider 结构体
  - [ ] `object/token.go` - Token 结构体

- [ ] 使用数据库工具查看表结构
  ```sql
  SHOW TABLES;
  DESC user;
  DESC organization;
  DESC application;
  ```

- [ ] 绘制核心实体 ER 图（使用 draw.io 或纸笔）
  - 标注实体间的关系（1对多、多对多）
  - 标注外键关系

#### Day 2：数据初始化机制
- [ ] 阅读 `object/init.go` 文件
- [ ] 理解 `InitFromFile()` 函数的作用
- [ ] 查看 `init_data.json.template` 文件
- [ ] 分析初始数据是如何插入的

**实践任务**：
- [ ] 修改 `init_data.json` 添加自定义组织
- [ ] 重新初始化数据库验证效果
  ```bash
  # 删除数据库重建
  mysql -u root -p -e "DROP DATABASE casdoor; CREATE DATABASE casdoor;"
  go run main.go
  ```

#### Day 3：ORM 层深入学习
- [ ] 学习 XORM 基础用法
  - 查询：`engine.Get()`, `engine.Find()`
  - 插入：`engine.Insert()`
  - 更新：`engine.Update()`
  - 删除：`engine.Delete()`

- [ ] 阅读以下文件理解 ORM 封装
  - `object/ormer.go` - 全局 ORM 引擎
  - `object/adapter.go` - 数据库适配器

**实践任务**：
- [ ] 在 `main.go` 中添加测试代码，查询所有用户
  ```go
  users := object.GetUsers("built-in")
  fmt.Printf("用户数量: %d\n", len(users))
  ```
- [ ] 编写一个函数统计每个组织的用户数量

### 验收标准 ✅

1. ✅ 能画出 User-Organization-Application 的关系图
2. ✅ 理解 Owner/Name 的唯一标识符设计
3. ✅ 能解释至少 5 个核心表的作用
4. ✅ 成功修改初始数据并重新加载
5. ✅ 能写简单的 XORM 查询代码

### 输出物
- [ ] 数据模型 ER 图（保存到 `mdoc/data-model.png`）
- [ ] 核心表说明文档（保存到 `mdoc/数据表说明.md`）

---

## 🎯 里程碑 3：掌握用户认证流程

**目标**：完整理解从登录到 Token 签发的全流程

**时间**：4天

### 任务清单

#### Day 1：登录流程追踪
- [ ] 在浏览器打开开发者工具
- [ ] 执行一次完整登录操作
- [ ] 记录所有 API 请求和响应
  - POST `/api/login`
  - GET `/api/get-account`

**代码阅读顺序**：
1. [ ] `controllers/auth.go` → `Login()` 方法
2. [ ] `object/user.go` → `CheckPassword()` 方法
3. [ ] `object/token_oauth.go` → `GetOAuthToken()` 方法
4. [ ] `object/token_jwt.go` → `GenerateJwtToken()` 方法

**实践任务**：
- [ ] 在 `Login()` 函数入口打断点
- [ ] 使用调试器单步跟踪登录流程
- [ ] 记录每一步的关键变量值

#### Day 2：密码验证机制
- [ ] 阅读 `cred/` 目录下的所有文件
  - `cred/bcrypt.go` - BCrypt 加密
  - `cred/argon2id.go` - Argon2id 加密
  - `cred/plain.go` - 明文（测试用）
  - `cred/manager.go` - 密码管理器

- [ ] 理解密码加密和验证流程
  ```go
  // 查看 User 结构体中的 Password 字段如何存储
  ```

**实践任务**：
- [ ] 创建一个测试程序验证密码加密
  ```go
  package main
  
  import (
      "fmt"
      "github.com/casdoor/casdoor/cred"
  )
  
  func main() {
      password := "123456"
      // 使用 bcrypt 加密
      credManager := cred.GetCredManager("bcrypt")
      hashed := credManager.GetHashedPassword(password, "", "")
      fmt.Println("加密后:", hashed)
      
      // 验证密码
      isValid := credManager.IsPasswordCorrect(password, hashed, "", "")
      fmt.Println("验证结果:", isValid)
  }
  ```

#### Day 3：Session 管理
- [ ] 阅读 `object/session.go`
- [ ] 理解 Session 的创建、存储、验证机制
- [ ] 查看 `main.go` 中 Session 配置
  ```go
  beego.BConfig.WebConfig.Session.SessionOn = true
  beego.BConfig.WebConfig.Session.SessionProvider = "file"  // 或 "redis"
  ```

**实践任务**：
- [ ] 查看浏览器 Cookie 中的 `casdoor_session_id`
- [ ] 在 `./tmp` 目录查看 Session 文件
- [ ] 配置 Redis 作为 Session 存储（可选）

#### Day 4：JWT Token 深入
- [ ] 阅读 `object/token_jwt.go` 完整代码
- [ ] 理解 JWT 的三部分：Header、Payload、Signature
- [ ] 查看 Token 签名使用的密钥管理
  - `object/cert.go` - 证书管理
  - `object/token_jwt_key.go` - JWT 密钥

**实践任务**：
- [ ] 在 https://jwt.io 解析实际的 Access Token
- [ ] 记录 Token 中包含的声明（claims）
  - sub（用户ID）
  - iss（签发者）
  - exp（过期时间）
  - scope（权限范围）

- [ ] 编写测试代码验证 Token
  ```go
  token := "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."
  claims, err := object.ParseJwtToken(token)
  if err != nil {
      fmt.Println("Token 无效:", err)
  } else {
      fmt.Printf("用户: %s\n", claims.User)
  }
  ```

### 验收标准 ✅

1. ✅ 能完整描述登录流程的每个步骤
2. ✅ 理解至少 3 种密码加密算法的区别
3. ✅ 能解释 Session 和 JWT Token 的区别和使用场景
4. ✅ 能手动解析和验证 JWT Token
5. ✅ 能够修改登录逻辑添加自定义验证

### 输出物
- [ ] 登录流程时序图（保存到 `mdoc/登录流程.png`）
- [ ] 认证机制总结文档（保存到 `mdoc/认证机制分析.md`）

---

## 🎯 里程碑 4：OAuth2/OIDC 协议实践

**目标**：掌握 OAuth2 授权码模式和 OIDC 协议实现

**时间**：4天

### 任务清单

#### Day 1：OAuth2 理论学习
- [ ] 阅读 OAuth2 RFC6749 规范（重点章节）
  - 授权码模式（Authorization Code）
  - 隐式模式（Implicit，已废弃）
  - 客户端凭证模式（Client Credentials）
  - 密码模式（Password，不推荐）

- [ ] 理解 OAuth2 核心概念
  - Resource Owner（资源所有者）
  - Client（客户端）
  - Authorization Server（授权服务器）
  - Resource Server（资源服务器）

**学习资源**：
- OAuth 2.0 Playground: https://www.oauth.com/playground/
- 阮一峰的 OAuth 教程

#### Day 2：授权码模式实践
**代码阅读**：
1. [ ] `controllers/auth.go` → 授权端点
2. [ ] `object/token_oauth.go` → Token 端点
3. [ ] `routers/router.go` → OAuth 路由配置

**实践任务**：创建一个测试应用
- [ ] 在 Casdoor 管理界面创建新应用
  - 名称：`test-oauth-app`
  - Redirect URLs：`http://localhost:9000/callback`
  - Grant Types：勾选 `Authorization Code`

- [ ] 手动构造授权请求 URL
  ```
  http://localhost:8000/login/oauth/authorize?
    client_id=<your_client_id>
    &response_type=code
    &redirect_uri=http://localhost:9000/callback
    &scope=read
    &state=random_state_string
  ```

- [ ] 使用 Postman 或 curl 获取 Access Token
  ```bash
  curl -X POST http://localhost:8000/api/login/oauth/access_token \
    -H "Content-Type: application/json" \
    -d '{
      "grant_type": "authorization_code",
      "client_id": "<your_client_id>",
      "client_secret": "<your_client_secret>",
      "code": "<authorization_code>",
      "redirect_uri": "http://localhost:9000/callback"
    }'
  ```

#### Day 3：OIDC 协议学习
- [ ] 理解 OIDC 与 OAuth2 的关系
  - OIDC = OAuth2 + 身份认证层
  - ID Token 的作用

**代码阅读**：
1. [ ] `controllers/oidc_discovery.go` → OIDC Discovery 端点
2. [ ] `object/oidc_discovery.go` → OIDC 元数据

**实践任务**：
- [ ] 访问 OIDC Discovery 端点
  ```bash
  curl http://localhost:8000/.well-known/openid-configuration
  ```
- [ ] 分析返回的 JSON 配置
  - `issuer`
  - `authorization_endpoint`
  - `token_endpoint`
  - `userinfo_endpoint`
  - `jwks_uri`

- [ ] 获取 JWKS（JSON Web Key Set）
  ```bash
  curl http://localhost:8000/.well-known/jwks
  ```

#### Day 4：实现一个 OAuth 客户端
**实践任务**：编写一个简单的 OAuth 客户端应用

创建文件 `oauth-client-demo/main.go`：
```go
package main

import (
    "fmt"
    "net/http"
    "io/ioutil"
)

const (
    clientID     = "your_client_id"
    clientSecret = "your_client_secret"
    redirectURI  = "http://localhost:9000/callback"
    authURL      = "http://localhost:8000/login/oauth/authorize"
    tokenURL     = "http://localhost:8000/api/login/oauth/access_token"
)

func main() {
    http.HandleFunc("/", handleHome)
    http.HandleFunc("/login", handleLogin)
    http.HandleFunc("/callback", handleCallback)
    
    fmt.Println("OAuth Client 运行在 http://localhost:9000")
    http.ListenAndServe(":9000", nil)
}

func handleHome(w http.ResponseWriter, r *http.Request) {
    html := `<html><body>
        <h1>OAuth 2.0 测试客户端</h1>
        <a href="/login">使用 Casdoor 登录</a>
    </body></html>`
    w.Write([]byte(html))
}

func handleLogin(w http.ResponseWriter, r *http.Request) {
    // 重定向到授权服务器
    url := fmt.Sprintf("%s?client_id=%s&response_type=code&redirect_uri=%s&scope=read&state=xyz",
        authURL, clientID, redirectURI)
    http.Redirect(w, r, url, http.StatusFound)
}

func handleCallback(w http.ResponseWriter, r *http.Request) {
    code := r.URL.Query().Get("code")
    state := r.URL.Query().Get("state")
    
    // 验证 state 防止 CSRF
    if state != "xyz" {
        http.Error(w, "Invalid state", http.StatusBadRequest)
        return
    }
    
    // 用 code 换取 access_token
    // TODO: 实现 token 获取逻辑
    
    fmt.Fprintf(w, "授权码: %s", code)
}
```

- [ ] 运行客户端应用并完成完整授权流程
- [ ] 验证能够获取 Access Token 和 Refresh Token

### 验收标准 ✅

1. ✅ 能用自己的话解释 OAuth2 授权码模式的流程
2. ✅ 理解 Authorization Code、Access Token、Refresh Token 的区别
3. ✅ 能访问并理解 OIDC Discovery 返回的配置
4. ✅ 成功实现一个简单的 OAuth 客户端
5. ✅ 能解释 ID Token 和 Access Token 的区别

### 输出物
- [ ] OAuth2 流程图（保存到 `mdoc/OAuth2-流程.png`）
- [ ] OAuth 客户端示例代码（保存到 `mdoc/oauth-client-demo/`）

---

## 🎯 里程碑 5：权限系统（Casbin）

**目标**：理解基于 Casbin 的权限控制实现

**时间**：3天

### 任务清单

#### Day 1：Casbin 基础学习
- [ ] 阅读 Casbin 官方文档
  - RBAC 模型
  - PERM 元模型
  - 策略（Policy）和模型（Model）

**实践任务**：
- [ ] 在本地创建 Casbin 测试项目
  ```go
  package main
  
  import (
      "fmt"
      "github.com/casbin/casbin/v2"
  )
  
  func main() {
      e, _ := casbin.NewEnforcer("model.conf", "policy.csv")
      
      // 测试权限
      sub := "alice"  // 用户
      obj := "data1"  // 资源
      act := "read"   // 操作
      
      ok, _ := e.Enforce(sub, obj, act)
      if ok {
          fmt.Println("允许访问")
      } else {
          fmt.Println("拒绝访问")
      }
  }
  ```

创建 `model.conf`：
```ini
[request_definition]
r = sub, obj, act

[policy_definition]
p = sub, obj, act

[role_definition]
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
m = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act
```

创建 `policy.csv`：
```csv
p, alice, data1, read
p, bob, data2, write
p, data_admin, data1, read
p, data_admin, data1, write
g, alice, data_admin
```

- [ ] 测试添加策略、删除策略、查询权限

#### Day 2：Casdoor 权限模型分析
**代码阅读**：
1. [ ] `authz/authz.go` - 权限初始化和执行
2. [ ] `object/permission.go` - 权限定义
3. [ ] `object/role.go` - 角色定义
4. [ ] `object/enforcer.go` - Enforcer 管理
5. [ ] `object/permission_enforcer.go` - 权限执行器

**实践任务**：
- [ ] 在 Casdoor 管理界面创建权限配置
  1. 创建一个角色：`editor`
  2. 创建一个权限：允许 `editor` 访问 `/api/get-users`
  3. 将用户分配到角色

- [ ] 在代码中查看权限如何存储
  ```sql
  SELECT * FROM permission;
  SELECT * FROM role;
  SELECT * FROM casbin_rule;
  ```

#### Day 3：权限检查流程实践
**代码阅读**：
- [ ] `routers/authz_filter.go` - 权限过滤器
- [ ] `controllers/base.go` - 基础控制器（权限检查）

**实践任务**：
- [ ] 为 API 端点添加权限检查
  ```go
  // 在 controllers/user.go 中
  func (c *ApiController) GetUsers() {
      // 检查权限
      ok := object.CheckPermission(user, resource, action)
      if !ok {
          c.ResponseError("无权限访问")
          return
      }
      // ... 业务逻辑
  }
  ```

- [ ] 测试权限拒绝场景
  1. 创建普通用户（无管理员权限）
  2. 尝试访问管理接口
  3. 验证返回 403 Forbidden

- [ ] 编写单元测试
  ```go
  func TestPermission(t *testing.T) {
      user := &object.User{Owner: "built-in", Name: "testuser"}
      ok := object.CheckPermission(user, "user", "read")
      assert.True(t, ok)
  }
  ```

### 验收标准 ✅

1. ✅ 理解 RBAC（基于角色的访问控制）概念
2. ✅ 能够独立编写 Casbin 策略文件
3. ✅ 理解 Casdoor 中权限、角色、用户的关系
4. ✅ 能够在界面配置角色和权限
5. ✅ 能够在代码中添加权限检查逻辑

### 输出物
- [ ] Casbin 权限模型说明（保存到 `mdoc/权限模型分析.md`）
- [ ] 权限配置示例（截图保存到 `mdoc/permission-config.png`）

---

## 🎯 里程碑 6：第三方登录集成

**目标**：理解并实现第三方 OAuth 登录（以 GitHub 为例）

**时间**：3天

### 任务清单

#### Day 1：第三方登录原理
**代码阅读**：
1. [ ] `idp/provider.go` - Provider 接口定义
2. [ ] `idp/github.go` - GitHub 登录实现
3. [ ] `idp/goth.go` - Goth 库封装

**实践任务**：
- [ ] 在 GitHub 创建 OAuth App
  1. 访问 https://github.com/settings/developers
  2. 点击 "New OAuth App"
  3. 填写信息：
     - Application name: `Casdoor Test`
     - Homepage URL: `http://localhost:8000`
     - Callback URL: `http://localhost:8000/api/callback`
  4. 获取 Client ID 和 Client Secret

#### Day 2：配置 GitHub 登录
**实践任务**：
- [ ] 在 Casdoor 管理界面创建 Provider
  1. 进入 "Providers" 页面
  2. 点击 "Add"
  3. 配置：
     - Category: `OAuth`
     - Type: `GitHub`
     - Client ID: `<your_client_id>`
     - Client Secret: `<your_client_secret>`
  4. 保存

- [ ] 在 Application 中启用 GitHub Provider
  1. 编辑应用
  2. 在 "Providers" 部分添加刚创建的 GitHub Provider
  3. 保存

- [ ] 测试 GitHub 登录
  1. 退出登录
  2. 在登录页面点击 GitHub 图标
  3. 完成 OAuth 授权
  4. 验证自动创建用户

#### Day 3：实现自定义 Provider
**实践任务**：为一个新的 OAuth 提供商（如 GitLab）添加支持

创建文件 `idp/gitlab.go`：
```go
package idp

import (
    "encoding/json"
    "fmt"
    "io/ioutil"
    "net/http"
    
    "golang.org/x/oauth2"
)

type GitLabIdProvider struct {
    Client *http.Client
    Config *oauth2.Config
}

func NewGitLabIdProvider(clientId string, clientSecret string, redirectUrl string) *GitLabIdProvider {
    idp := &GitLabIdProvider{}
    
    config := &oauth2.Config{
        ClientID:     clientId,
        ClientSecret: clientSecret,
        RedirectURL:  redirectUrl,
        Scopes:       []string{"read_user"},
        Endpoint: oauth2.Endpoint{
            AuthURL:  "https://gitlab.com/oauth/authorize",
            TokenURL: "https://gitlab.com/oauth/token",
        },
    }
    
    idp.Config = config
    return idp
}

func (idp *GitLabIdProvider) GetToken(code string) (*oauth2.Token, error) {
    return idp.Config.Exchange(oauth2.NoContext, code)
}

func (idp *GitLabIdProvider) GetUserInfo(token *oauth2.Token) (*UserInfo, error) {
    client := idp.Config.Client(oauth2.NoContext, token)
    response, err := client.Get("https://gitlab.com/api/v4/user")
    if err != nil {
        return nil, err
    }
    defer response.Body.Close()
    
    body, err := ioutil.ReadAll(response.Body)
    if err != nil {
        return nil, err
    }
    
    var gitlabUser struct {
        ID       int    `json:"id"`
        Username string `json:"username"`
        Name     string `json:"name"`
        Email    string `json:"email"`
        Avatar   string `json:"avatar_url"`
    }
    
    err = json.Unmarshal(body, &gitlabUser)
    if err != nil {
        return nil, err
    }
    
    userInfo := &UserInfo{
        Id:          fmt.Sprintf("%d", gitlabUser.ID),
        Username:    gitlabUser.Username,
        DisplayName: gitlabUser.Name,
        Email:       gitlabUser.Email,
        AvatarUrl:   gitlabUser.Avatar,
    }
    
    return userInfo, nil
}
```

- [ ] 在 `idp/provider.go` 中注册 GitLab Provider
- [ ] 测试 GitLab 登录功能

### 验收标准 ✅

1. ✅ 理解第三方 OAuth 登录的完整流程
2. ✅ 成功配置并测试 GitHub 登录
3. ✅ 理解用户信息如何从第三方同步到 Casdoor
4. ✅ 能够添加一个新的第三方登录提供商
5. ✅ 理解 `markbates/goth` 库的作用

### 输出物
- [ ] 第三方登录流程图（保存到 `mdoc/第三方登录流程.png`）
- [ ] 自定义 Provider 实现代码（如果完成）

---

## 🎯 里程碑 7：前端架构学习

**目标**：理解 React 前端的架构和核心功能

**时间**：3天

### 任务清单

#### Day 1：前端项目结构分析
- [ ] 查看 `web/package.json` 了解依赖
  - React 版本
  - Ant Design 版本
  - 路由库（react-router-dom）
  - 国际化（i18next）

**目录结构学习**：
```
web/
├── public/          # 静态资源
├── src/
│   ├── auth/        # 认证相关页面
│   ├── backend/     # API 调用封装
│   ├── components/  # 通用组件
│   ├── locales/     # 多语言文件
│   ├── App.js       # 主应用组件
│   └── index.js     # 入口文件
└── package.json
```

- [ ] 阅读 `web/src/App.js`
- [ ] 理解路由配置
  ```javascript
  <Route path="/login" element={<LoginPage />} />
  <Route path="/users" element={<UserListPage />} />
  // ... 其他路由
  ```

#### Day 2：核心页面分析
**实践任务**：
- [ ] 登录页面：`web/src/auth/LoginPage.js`
  - 理解表单提交逻辑
  - 查看 API 调用方式
  - 理解 Token 存储（localStorage）

- [ ] 用户管理页面：`web/src/UserListPage.js`
  - Ant Design Table 组件使用
  - 分页、搜索、过滤功能
  - CRUD 操作实现

- [ ] 用户编辑页面：`web/src/UserEditPage.js`
  - 表单验证
  - 图片上传
  - 数据提交

**代码阅读重点**：
```javascript
// API 调用示例
import * as UserBackend from './backend/UserBackend';

// 获取用户列表
UserBackend.getUsers("built-in")
  .then(res => {
    this.setState({users: res.data});
  });

// 更新用户
UserBackend.updateUser(user)
  .then(res => {
    if (res.status === "ok") {
      // 成功提示
    }
  });
```

#### Day 3：前后端交互与状态管理
**实践任务**：
- [ ] 查看 `web/src/backend/` 目录
  - `UserBackend.js` - 用户相关 API
  - `ApplicationBackend.js` - 应用相关 API
  - `AuthBackend.js` - 认证相关 API

- [ ] 理解 API 请求封装
  ```javascript
  export function getUsers(owner) {
    return fetch(`${Setting.ServerUrl}/api/get-users?owner=${owner}`, {
      method: "GET",
      credentials: "include",  // 携带 Cookie
    }).then(res => res.json());
  }
  ```

- [ ] 学习认证状态管理
  - Token 存储位置
  - 登录状态检查
  - 自动跳转逻辑

**修改实践**：
- [ ] 在用户列表页面添加一个新列
- [ ] 修改登录页面的样式
- [ ] 添加一个自定义提示消息

### 验收标准 ✅

1. ✅ 理解 React 项目的目录结构
2. ✅ 能够独立修改一个页面的样式和布局
3. ✅ 理解前后端 API 交互方式
4. ✅ 能够添加一个新的表单字段并保存到后端
5. ✅ 理解多语言国际化的实现方式

### 输出物
- [ ] 前端架构说明文档（保存到 `mdoc/前端架构.md`）
- [ ] 页面修改示例代码（截图）

---

## 🎯 里程碑 8：高级功能模块

**目标**：掌握 MFA、SAML、LDAP 等高级功能

**时间**：4天

### 任务清单

#### Day 1：多因素认证（MFA）
**代码阅读**：
1. [ ] `object/mfa.go` - MFA 核心逻辑
2. [ ] `object/mfa_totp.go` - TOTP 实现
3. [ ] `controllers/mfa.go` - MFA API

**实践任务**：
- [ ] 为测试用户启用 TOTP MFA
  1. 登录测试用户
  2. 进入个人设置
  3. 启用 MFA
  4. 使用 Google Authenticator 扫描二维码
  5. 输入验证码完成绑定

- [ ] 测试 MFA 登录流程
  1. 退出登录
  2. 使用用户名密码登录
  3. 输入 MFA 验证码
  4. 成功进入系统

- [ ] 查看 TOTP 生成逻辑
  ```go
  // pquerna/otp 库的使用
  key, _ := totp.Generate(totp.GenerateOpts{
      Issuer:      "Casdoor",
      AccountName: user.Name,
  })
  ```

#### Day 2：SAML 协议
**理论学习**：
- [ ] 阅读 SAML 2.0 基础知识
  - SP（Service Provider）
  - IdP（Identity Provider）
  - SSO 流程

**代码阅读**：
1. [ ] `controllers/saml.go`
2. [ ] `object/saml_sp.go` - SP 实现
3. [ ] `object/saml_idp.go` - IdP 实现

**实践任务**：
- [ ] 配置 Casdoor 作为 SAML IdP
  1. 创建一个支持 SAML 的应用
  2. 配置 SAML 相关参数
  3. 下载 SAML 元数据
     ```bash
     curl http://localhost:8000/api/saml/metadata > metadata.xml
     ```

- [ ] 使用 SAML 测试工具验证
  - 在线工具：https://www.samltool.com/

#### Day 3：LDAP 服务器
**代码阅读**：
1. [ ] `ldap/server.go` - LDAP 服务器实现
2. [ ] `ldap/util.go` - LDAP 工具函数
3. [ ] `object/ldap.go` - LDAP 用户同步

**实践任务**：
- [ ] 启动 LDAP 服务器（默认端口 389）
- [ ] 使用 LDAP 客户端测试连接
  ```bash
  # 安装 ldapsearch
  brew install openldap  # macOS
  # apt-get install ldap-utils  # Ubuntu
  
  # 测试查询
  ldapsearch -x -H ldap://localhost:389 \
    -D "cn=admin,dc=example,dc=com" \
    -w "123" \
    -b "ou=People,dc=example,dc=com"
  ```

- [ ] 配置 LDAP 同步
  1. 创建 LDAP Syncer
  2. 配置外部 LDAP 服务器连接
  3. 执行同步任务

#### Day 4：Webhook 和通知
**代码阅读**：
1. [ ] `object/webhook.go` - Webhook 管理
2. [ ] `notification/` 目录 - 各种通知渠道
   - `notification/email.go`
   - `notification/slack.go`
   - `notification/dingtalk.go`

**实践任务**：
- [ ] 创建 Webhook
  1. 在管理界面创建 Webhook
  2. 配置触发事件（如用户注册）
  3. 设置回调 URL

- [ ] 搭建测试服务器接收 Webhook
  ```go
  package main
  
  import (
      "fmt"
      "io/ioutil"
      "net/http"
  )
  
  func main() {
      http.HandleFunc("/webhook", func(w http.ResponseWriter, r *http.Request) {
          body, _ := ioutil.ReadAll(r.Body)
          fmt.Printf("收到 Webhook: %s\n", string(body))
          w.WriteHeader(200)
      })
      
      http.ListenAndServe(":9000", nil)
  }
  ```

- [ ] 触发事件并验证 Webhook 调用

### 验收标准 ✅

1. ✅ 成功配置并测试 TOTP MFA
2. ✅ 理解 SAML SSO 的基本流程
3. ✅ 能够通过 LDAP 协议访问 Casdoor 用户
4. ✅ 成功配置并接收 Webhook 通知
5. ✅ 理解各功能模块的应用场景

### 输出物
- [ ] MFA 配置指南（保存到 `mdoc/MFA配置指南.md`）
- [ ] LDAP 测试报告（保存到 `mdoc/LDAP测试.md`）

---

## 🎯 里程碑 9：实战项目开发

**目标**：独立开发一个完整功能模块

**时间**：5天

### 项目选择（三选一）

#### 项目 A：自定义登录页面主题
**需求**：
- 支持管理员自定义登录页面
- 可配置 Logo、背景图、主题色
- 预览功能

**技术要点**：
- 前端：React 组件开发
- 后端：配置存储和读取
- 文件上传功能

#### 项目 B：用户行为审计日志
**需求**：
- 记录所有用户操作（登录、修改资料等）
- 审计日志查询和导出
- 敏感操作告警

**技术要点**：
- 中间件开发
- 数据库设计
- 日志查询优化

#### 项目 C：API 访问频率限制
**需求**：
- 对 API 进行频率限制
- 支持按用户、IP 限制
- 限制规则可配置

**技术要点**：
- 中间件开发
- Redis 缓存
- 限流算法（令牌桶/漏桶）

### 开发步骤

#### Day 1：需求分析和设计
- [ ] 编写需求文档
- [ ] 设计数据库表结构（如需要）
- [ ] 设计 API 接口
- [ ] 绘制功能流程图

#### Day 2-3：后端开发
- [ ] 创建数据模型
- [ ] 实现业务逻辑
- [ ] 添加 API 端点
- [ ] 编写单元测试

#### Day 4：前端开发
- [ ] 创建管理页面
- [ ] 实现表单和列表
- [ ] 对接后端 API
- [ ] 样式优化

#### Day 5：测试和文档
- [ ] 功能测试
- [ ] Bug 修复
- [ ] 编写使用文档
- [ ] 代码注释完善

### 验收标准 ✅

1. ✅ 功能完整可用
2. ✅ 代码符合项目规范
3. ✅ 有单元测试覆盖
4. ✅ 有完整的使用文档
5. ✅ 无明显 Bug

### 输出物
- [ ] 功能设计文档（保存到 `mdoc/实战项目-设计.md`）
- [ ] 源代码（提交到 Git 分支）
- [ ] 使用文档（保存到 `mdoc/实战项目-使用手册.md`）
- [ ] 演示视频或截图

---

## 📊 学习评估与总结

### 最终检验清单

#### 理论知识
- [ ] 能解释 OAuth2 和 OIDC 的区别
- [ ] 能说明 JWT 的组成和验证流程
- [ ] 理解 RBAC 权限模型
- [ ] 了解 SAML、CAS、LDAP 协议

#### 实践能力
- [ ] 能独立部署 Casdoor
- [ ] 能为新应用接入 Casdoor 认证
- [ ] 能配置第三方登录
- [ ] 能添加新的功能模块

#### 代码能力
- [ ] 能读懂 Casdoor 核心代码
- [ ] 能修改和扩展功能
- [ ] 能编写测试用例
- [ ] 能解决常见问题

### 项目总结报告

完成所有里程碑后，编写一份总结报告：

**保存到 `mdoc/学习总结报告.md`**

内容包括：
1. 学习路径回顾
2. 遇到的主要问题和解决方案
3. 核心技术理解
4. 实战项目展示
5. 后续学习计划

---

## 🔗 参考资源

### 官方文档
- Casdoor 文档：https://casdoor.org
- Casbin 文档：https://casbin.org
- Beego 文档：https://beego.wiki

### 协议规范
- OAuth 2.0 RFC6749：https://tools.ietf.org/html/rfc6749
- OpenID Connect：https://openid.net/connect/
- SAML 2.0：http://docs.oasis-open.org/security/saml/

### 学习资源
- OAuth 2.0 Playground：https://www.oauth.com/playground/
- JWT.io：https://jwt.io
- SAML Tool：https://www.samltool.com

### 社区
- GitHub Issues：https://github.com/casdoor/casdoor/issues
- Discord：https://discord.gg/5rPsrAzK7S

---

## 📝 每日学习记录模板

在 `mdoc/` 目录下创建日志文件记录学习进度：

**文件名**：`学习日志-YYYY-MM-DD.md`

```markdown
# 学习日志 - YYYY-MM-DD

## 今日目标
- [ ] 目标1
- [ ] 目标2

## 学习内容
### 上午
- 阅读的代码文件：
- 关键发现：

### 下午
- 实践的任务：
- 遇到的问题：

## 代码笔记
\`\`\`go
// 关键代码片段
\`\`\`

## 问题记录
1. 问题描述：
   解决方案：

## 明天计划
- 
```

---

## 🎉 结语

这份学习计划是一个指导框架，请根据自己的实际情况灵活调整：

- ⏰ **时间安排**：可以加快或放慢节奏
- 📚 **深度选择**：某些模块可以跳过或深入
- 🎯 **项目选择**：根据兴趣选择实战项目
- 🔄 **迭代学习**：遇到难点可以回头复习

**记住**：学习源码最重要的是：
1. **动手实践** - 不要只看代码，要运行和调试
2. **做好笔记** - 记录关键理解和问题
3. **提出问题** - 不懂就问，参与社区讨论
4. **持续学习** - 技术在发展，保持学习热情

祝学习顺利！🚀

