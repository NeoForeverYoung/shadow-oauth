# Casdoor é¡¹ç›®å­¦ä¹ é‡Œç¨‹ç¢‘è®¡åˆ’

> **ç›®æ ‡ç”¨æˆ·**ï¼š3å¹´å¼€å‘ç»éªŒç¨‹åºå‘˜  
> **æ€»é¢„è®¡æ—¶é—´**ï¼š3-4å‘¨ï¼ˆæ¯å¤©6å°æ—¶ï¼‰  
> **æœ€åæ›´æ–°**ï¼š2025-10-20

---

## ğŸ“Š å­¦ä¹ è¿›åº¦æ¦‚è§ˆ

- [ ] é‡Œç¨‹ç¢‘ 1ï¼šç¯å¢ƒæ­å»ºä¸é¡¹ç›®è¿è¡Œï¼ˆ2å¤©ï¼‰
- [ ] é‡Œç¨‹ç¢‘ 2ï¼šç†è§£æ ¸å¿ƒæ•°æ®æ¨¡å‹ï¼ˆ3å¤©ï¼‰
- [ ] é‡Œç¨‹ç¢‘ 3ï¼šæŒæ¡ç”¨æˆ·è®¤è¯æµç¨‹ï¼ˆ4å¤©ï¼‰
- [ ] é‡Œç¨‹ç¢‘ 4ï¼šOAuth2/OIDC åè®®å®è·µï¼ˆ4å¤©ï¼‰
- [ ] é‡Œç¨‹ç¢‘ 5ï¼šæƒé™ç³»ç»Ÿï¼ˆCasbinï¼‰ï¼ˆ3å¤©ï¼‰
- [ ] é‡Œç¨‹ç¢‘ 6ï¼šç¬¬ä¸‰æ–¹ç™»å½•é›†æˆï¼ˆ3å¤©ï¼‰
- [ ] é‡Œç¨‹ç¢‘ 7ï¼šå‰ç«¯æ¶æ„å­¦ä¹ ï¼ˆ3å¤©ï¼‰
- [ ] é‡Œç¨‹ç¢‘ 8ï¼šé«˜çº§åŠŸèƒ½æ¨¡å—ï¼ˆ4å¤©ï¼‰
- [ ] é‡Œç¨‹ç¢‘ 9ï¼šå®æˆ˜é¡¹ç›®å¼€å‘ï¼ˆ5å¤©ï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 1ï¼šç¯å¢ƒæ­å»ºä¸é¡¹ç›®è¿è¡Œ

**ç›®æ ‡**ï¼šæˆåŠŸåœ¨æœ¬åœ°è¿è¡Œ Casdoor å‰åç«¯ï¼Œå¹¶èƒ½è®¿é—®ç®¡ç†ç•Œé¢

**æ—¶é—´**ï¼š2å¤©

### ä»»åŠ¡æ¸…å•

#### Day 1ï¼šåç«¯ç¯å¢ƒæ­å»º
- [ ] å®‰è£… Go 1.21+ ç¯å¢ƒ
  ```bash
  go version  # éªŒè¯ç‰ˆæœ¬
  ```
- [ ] å®‰è£… MySQL æ•°æ®åº“
  ```bash
  mysql -V  # éªŒè¯å®‰è£…
  ```
- [ ] é…ç½®æ•°æ®åº“
  ```sql
  CREATE DATABASE casdoor;
  CREATE USER 'casdoor'@'localhost' IDENTIFIED BY 'casdoor123';
  GRANT ALL PRIVILEGES ON casdoor.* TO 'casdoor'@'localhost';
  FLUSH PRIVILEGES;
  ```
- [ ] ä¿®æ”¹é…ç½®æ–‡ä»¶ `conf/app.conf`
  ```ini
  dataSourceName = casdoor:casdoor123@tcp(localhost:3306)/
  dbName = casdoor
  ```
- [ ] å®‰è£… Go ä¾èµ–
  ```bash
  go mod download
  go mod tidy
  ```
- [ ] å¯åŠ¨åç«¯æœåŠ¡
  ```bash
  go run main.go
  ```
- [ ] éªŒè¯å¯åŠ¨æˆåŠŸï¼šè®¿é—® http://localhost:8000

#### Day 2ï¼šå‰ç«¯ç¯å¢ƒæ­å»º
- [ ] å®‰è£… Node.js 16+ å’Œ npm/yarn
  ```bash
  node -v
  npm -v
  ```
- [ ] è¿›å…¥å‰ç«¯ç›®å½•å¹¶å®‰è£…ä¾èµ–
  ```bash
  cd web
  npm install
  ```
- [ ] å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
  ```bash
  npm start
  ```
- [ ] è®¿é—®å‰ç«¯ï¼šhttp://localhost:7001
- [ ] ä½¿ç”¨é»˜è®¤è´¦å·ç™»å½•ï¼š`admin` / `123`
- [ ] æµè§ˆæ‰€æœ‰ä¸»è¦ç®¡ç†é¡µé¢
  - ç»„ç»‡ç®¡ç†
  - ç”¨æˆ·ç®¡ç†
  - åº”ç”¨ç®¡ç†
  - æä¾›å•†ç®¡ç†

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… åç«¯æœåŠ¡æ­£å¸¸å¯åŠ¨ï¼Œæ— é”™è¯¯æ—¥å¿—
2. âœ… æ•°æ®åº“è¡¨è‡ªåŠ¨åˆ›å»ºæˆåŠŸï¼ˆè‡³å°‘20+å¼ è¡¨ï¼‰
3. âœ… å‰ç«¯é¡µé¢æ­£å¸¸åŠ è½½ï¼Œæ—  Console é”™è¯¯
4. âœ… èƒ½å¤Ÿä½¿ç”¨ admin è´¦å·ç™»å½•ç³»ç»Ÿ
5. âœ… èƒ½å¤Ÿåœ¨ç•Œé¢ä¸Šåˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·
6. âœ… èƒ½å¤Ÿçœ‹åˆ° Swagger API æ–‡æ¡£ï¼šhttp://localhost:8000/swagger

### å­¦ä¹ ç¬”è®°æ¨¡æ¿
```markdown
## æˆ‘çš„ç¯å¢ƒé…ç½®
- æ“ä½œç³»ç»Ÿï¼š
- Go ç‰ˆæœ¬ï¼š
- Node ç‰ˆæœ¬ï¼š
- æ•°æ®åº“ç‰ˆæœ¬ï¼š

## é‡åˆ°çš„é—®é¢˜
1. é—®é¢˜æè¿°ï¼š
   è§£å†³æ–¹æ¡ˆï¼š

## å…³é”®å‘ç°
- 
```

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 2ï¼šç†è§£æ ¸å¿ƒæ•°æ®æ¨¡å‹

**ç›®æ ‡**ï¼šæŒæ¡ Casdoor çš„æ ¸å¿ƒæ•°æ®ç»“æ„å’Œè¡¨å…³ç³»

**æ—¶é—´**ï¼š3å¤©

### ä»»åŠ¡æ¸…å•

#### Day 1ï¼šæ•°æ®æ¨¡å‹åˆ†æ
- [ ] é˜…è¯»å¹¶ç†è§£ä»¥ä¸‹æ ¸å¿ƒæ¨¡å‹ä»£ç 
  - [ ] `object/user.go` - User ç»“æ„ä½“å®šä¹‰ï¼ˆé‡ç‚¹å…³æ³¨å­—æ®µå«ä¹‰ï¼‰
  - [ ] `object/organization.go` - Organization ç»“æ„ä½“
  - [ ] `object/application.go` - Application ç»“æ„ä½“
  - [ ] `object/provider.go` - Provider ç»“æ„ä½“
  - [ ] `object/token.go` - Token ç»“æ„ä½“

- [ ] ä½¿ç”¨æ•°æ®åº“å·¥å…·æŸ¥çœ‹è¡¨ç»“æ„
  ```sql
  SHOW TABLES;
  DESC user;
  DESC organization;
  DESC application;
  ```

- [ ] ç»˜åˆ¶æ ¸å¿ƒå®ä½“ ER å›¾ï¼ˆä½¿ç”¨ draw.io æˆ–çº¸ç¬”ï¼‰
  - æ ‡æ³¨å®ä½“é—´çš„å…³ç³»ï¼ˆ1å¯¹å¤šã€å¤šå¯¹å¤šï¼‰
  - æ ‡æ³¨å¤–é”®å…³ç³»

#### Day 2ï¼šæ•°æ®åˆå§‹åŒ–æœºåˆ¶
- [ ] é˜…è¯» `object/init.go` æ–‡ä»¶
- [ ] ç†è§£ `InitFromFile()` å‡½æ•°çš„ä½œç”¨
- [ ] æŸ¥çœ‹ `init_data.json.template` æ–‡ä»¶
- [ ] åˆ†æåˆå§‹æ•°æ®æ˜¯å¦‚ä½•æ’å…¥çš„

**å®è·µä»»åŠ¡**ï¼š
- [ ] ä¿®æ”¹ `init_data.json` æ·»åŠ è‡ªå®šä¹‰ç»„ç»‡
- [ ] é‡æ–°åˆå§‹åŒ–æ•°æ®åº“éªŒè¯æ•ˆæœ
  ```bash
  # åˆ é™¤æ•°æ®åº“é‡å»º
  mysql -u root -p -e "DROP DATABASE casdoor; CREATE DATABASE casdoor;"
  go run main.go
  ```

#### Day 3ï¼šORM å±‚æ·±å…¥å­¦ä¹ 
- [ ] å­¦ä¹  XORM åŸºç¡€ç”¨æ³•
  - æŸ¥è¯¢ï¼š`engine.Get()`, `engine.Find()`
  - æ’å…¥ï¼š`engine.Insert()`
  - æ›´æ–°ï¼š`engine.Update()`
  - åˆ é™¤ï¼š`engine.Delete()`

- [ ] é˜…è¯»ä»¥ä¸‹æ–‡ä»¶ç†è§£ ORM å°è£…
  - `object/ormer.go` - å…¨å±€ ORM å¼•æ“
  - `object/adapter.go` - æ•°æ®åº“é€‚é…å™¨

**å®è·µä»»åŠ¡**ï¼š
- [ ] åœ¨ `main.go` ä¸­æ·»åŠ æµ‹è¯•ä»£ç ï¼ŒæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
  ```go
  users := object.GetUsers("built-in")
  fmt.Printf("ç”¨æˆ·æ•°é‡: %d\n", len(users))
  ```
- [ ] ç¼–å†™ä¸€ä¸ªå‡½æ•°ç»Ÿè®¡æ¯ä¸ªç»„ç»‡çš„ç”¨æˆ·æ•°é‡

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… èƒ½ç”»å‡º User-Organization-Application çš„å…³ç³»å›¾
2. âœ… ç†è§£ Owner/Name çš„å”¯ä¸€æ ‡è¯†ç¬¦è®¾è®¡
3. âœ… èƒ½è§£é‡Šè‡³å°‘ 5 ä¸ªæ ¸å¿ƒè¡¨çš„ä½œç”¨
4. âœ… æˆåŠŸä¿®æ”¹åˆå§‹æ•°æ®å¹¶é‡æ–°åŠ è½½
5. âœ… èƒ½å†™ç®€å•çš„ XORM æŸ¥è¯¢ä»£ç 

### è¾“å‡ºç‰©
- [ ] æ•°æ®æ¨¡å‹ ER å›¾ï¼ˆä¿å­˜åˆ° `mdoc/data-model.png`ï¼‰
- [ ] æ ¸å¿ƒè¡¨è¯´æ˜æ–‡æ¡£ï¼ˆä¿å­˜åˆ° `mdoc/æ•°æ®è¡¨è¯´æ˜.md`ï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 3ï¼šæŒæ¡ç”¨æˆ·è®¤è¯æµç¨‹

**ç›®æ ‡**ï¼šå®Œæ•´ç†è§£ä»ç™»å½•åˆ° Token ç­¾å‘çš„å…¨æµç¨‹

**æ—¶é—´**ï¼š4å¤©

### ä»»åŠ¡æ¸…å•

#### Day 1ï¼šç™»å½•æµç¨‹è¿½è¸ª
- [ ] åœ¨æµè§ˆå™¨æ‰“å¼€å¼€å‘è€…å·¥å…·
- [ ] æ‰§è¡Œä¸€æ¬¡å®Œæ•´ç™»å½•æ“ä½œ
- [ ] è®°å½•æ‰€æœ‰ API è¯·æ±‚å’Œå“åº”
  - POST `/api/login`
  - GET `/api/get-account`

**ä»£ç é˜…è¯»é¡ºåº**ï¼š
1. [ ] `controllers/auth.go` â†’ `Login()` æ–¹æ³•
2. [ ] `object/user.go` â†’ `CheckPassword()` æ–¹æ³•
3. [ ] `object/token_oauth.go` â†’ `GetOAuthToken()` æ–¹æ³•
4. [ ] `object/token_jwt.go` â†’ `GenerateJwtToken()` æ–¹æ³•

**å®è·µä»»åŠ¡**ï¼š
- [ ] åœ¨ `Login()` å‡½æ•°å…¥å£æ‰“æ–­ç‚¹
- [ ] ä½¿ç”¨è°ƒè¯•å™¨å•æ­¥è·Ÿè¸ªç™»å½•æµç¨‹
- [ ] è®°å½•æ¯ä¸€æ­¥çš„å…³é”®å˜é‡å€¼

#### Day 2ï¼šå¯†ç éªŒè¯æœºåˆ¶
- [ ] é˜…è¯» `cred/` ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
  - `cred/bcrypt.go` - BCrypt åŠ å¯†
  - `cred/argon2id.go` - Argon2id åŠ å¯†
  - `cred/plain.go` - æ˜æ–‡ï¼ˆæµ‹è¯•ç”¨ï¼‰
  - `cred/manager.go` - å¯†ç ç®¡ç†å™¨

- [ ] ç†è§£å¯†ç åŠ å¯†å’ŒéªŒè¯æµç¨‹
  ```go
  // æŸ¥çœ‹ User ç»“æ„ä½“ä¸­çš„ Password å­—æ®µå¦‚ä½•å­˜å‚¨
  ```

**å®è·µä»»åŠ¡**ï¼š
- [ ] åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç¨‹åºéªŒè¯å¯†ç åŠ å¯†
  ```go
  package main
  
  import (
      "fmt"
      "github.com/casdoor/casdoor/cred"
  )
  
  func main() {
      password := "123456"
      // ä½¿ç”¨ bcrypt åŠ å¯†
      credManager := cred.GetCredManager("bcrypt")
      hashed := credManager.GetHashedPassword(password, "", "")
      fmt.Println("åŠ å¯†å:", hashed)
      
      // éªŒè¯å¯†ç 
      isValid := credManager.IsPasswordCorrect(password, hashed, "", "")
      fmt.Println("éªŒè¯ç»“æœ:", isValid)
  }
  ```

#### Day 3ï¼šSession ç®¡ç†
- [ ] é˜…è¯» `object/session.go`
- [ ] ç†è§£ Session çš„åˆ›å»ºã€å­˜å‚¨ã€éªŒè¯æœºåˆ¶
- [ ] æŸ¥çœ‹ `main.go` ä¸­ Session é…ç½®
  ```go
  beego.BConfig.WebConfig.Session.SessionOn = true
  beego.BConfig.WebConfig.Session.SessionProvider = "file"  // æˆ– "redis"
  ```

**å®è·µä»»åŠ¡**ï¼š
- [ ] æŸ¥çœ‹æµè§ˆå™¨ Cookie ä¸­çš„ `casdoor_session_id`
- [ ] åœ¨ `./tmp` ç›®å½•æŸ¥çœ‹ Session æ–‡ä»¶
- [ ] é…ç½® Redis ä½œä¸º Session å­˜å‚¨ï¼ˆå¯é€‰ï¼‰

#### Day 4ï¼šJWT Token æ·±å…¥
- [ ] é˜…è¯» `object/token_jwt.go` å®Œæ•´ä»£ç 
- [ ] ç†è§£ JWT çš„ä¸‰éƒ¨åˆ†ï¼šHeaderã€Payloadã€Signature
- [ ] æŸ¥çœ‹ Token ç­¾åä½¿ç”¨çš„å¯†é’¥ç®¡ç†
  - `object/cert.go` - è¯ä¹¦ç®¡ç†
  - `object/token_jwt_key.go` - JWT å¯†é’¥

**å®è·µä»»åŠ¡**ï¼š
- [ ] åœ¨ https://jwt.io è§£æå®é™…çš„ Access Token
- [ ] è®°å½• Token ä¸­åŒ…å«çš„å£°æ˜ï¼ˆclaimsï¼‰
  - subï¼ˆç”¨æˆ·IDï¼‰
  - issï¼ˆç­¾å‘è€…ï¼‰
  - expï¼ˆè¿‡æœŸæ—¶é—´ï¼‰
  - scopeï¼ˆæƒé™èŒƒå›´ï¼‰

- [ ] ç¼–å†™æµ‹è¯•ä»£ç éªŒè¯ Token
  ```go
  token := "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."
  claims, err := object.ParseJwtToken(token)
  if err != nil {
      fmt.Println("Token æ— æ•ˆ:", err)
  } else {
      fmt.Printf("ç”¨æˆ·: %s\n", claims.User)
  }
  ```

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… èƒ½å®Œæ•´æè¿°ç™»å½•æµç¨‹çš„æ¯ä¸ªæ­¥éª¤
2. âœ… ç†è§£è‡³å°‘ 3 ç§å¯†ç åŠ å¯†ç®—æ³•çš„åŒºåˆ«
3. âœ… èƒ½è§£é‡Š Session å’Œ JWT Token çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯
4. âœ… èƒ½æ‰‹åŠ¨è§£æå’ŒéªŒè¯ JWT Token
5. âœ… èƒ½å¤Ÿä¿®æ”¹ç™»å½•é€»è¾‘æ·»åŠ è‡ªå®šä¹‰éªŒè¯

### è¾“å‡ºç‰©
- [ ] ç™»å½•æµç¨‹æ—¶åºå›¾ï¼ˆä¿å­˜åˆ° `mdoc/ç™»å½•æµç¨‹.png`ï¼‰
- [ ] è®¤è¯æœºåˆ¶æ€»ç»“æ–‡æ¡£ï¼ˆä¿å­˜åˆ° `mdoc/è®¤è¯æœºåˆ¶åˆ†æ.md`ï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 4ï¼šOAuth2/OIDC åè®®å®è·µ

**ç›®æ ‡**ï¼šæŒæ¡ OAuth2 æˆæƒç æ¨¡å¼å’Œ OIDC åè®®å®ç°

**æ—¶é—´**ï¼š4å¤©

### ä»»åŠ¡æ¸…å•

#### Day 1ï¼šOAuth2 ç†è®ºå­¦ä¹ 
- [ ] é˜…è¯» OAuth2 RFC6749 è§„èŒƒï¼ˆé‡ç‚¹ç« èŠ‚ï¼‰
  - æˆæƒç æ¨¡å¼ï¼ˆAuthorization Codeï¼‰
  - éšå¼æ¨¡å¼ï¼ˆImplicitï¼Œå·²åºŸå¼ƒï¼‰
  - å®¢æˆ·ç«¯å‡­è¯æ¨¡å¼ï¼ˆClient Credentialsï¼‰
  - å¯†ç æ¨¡å¼ï¼ˆPasswordï¼Œä¸æ¨èï¼‰

- [ ] ç†è§£ OAuth2 æ ¸å¿ƒæ¦‚å¿µ
  - Resource Ownerï¼ˆèµ„æºæ‰€æœ‰è€…ï¼‰
  - Clientï¼ˆå®¢æˆ·ç«¯ï¼‰
  - Authorization Serverï¼ˆæˆæƒæœåŠ¡å™¨ï¼‰
  - Resource Serverï¼ˆèµ„æºæœåŠ¡å™¨ï¼‰

**å­¦ä¹ èµ„æº**ï¼š
- OAuth 2.0 Playground: https://www.oauth.com/playground/
- é˜®ä¸€å³°çš„ OAuth æ•™ç¨‹

#### Day 2ï¼šæˆæƒç æ¨¡å¼å®è·µ
**ä»£ç é˜…è¯»**ï¼š
1. [ ] `controllers/auth.go` â†’ æˆæƒç«¯ç‚¹
2. [ ] `object/token_oauth.go` â†’ Token ç«¯ç‚¹
3. [ ] `routers/router.go` â†’ OAuth è·¯ç”±é…ç½®

**å®è·µä»»åŠ¡**ï¼šåˆ›å»ºä¸€ä¸ªæµ‹è¯•åº”ç”¨
- [ ] åœ¨ Casdoor ç®¡ç†ç•Œé¢åˆ›å»ºæ–°åº”ç”¨
  - åç§°ï¼š`test-oauth-app`
  - Redirect URLsï¼š`http://localhost:9000/callback`
  - Grant Typesï¼šå‹¾é€‰ `Authorization Code`

- [ ] æ‰‹åŠ¨æ„é€ æˆæƒè¯·æ±‚ URL
  ```
  http://localhost:8000/login/oauth/authorize?
    client_id=<your_client_id>
    &response_type=code
    &redirect_uri=http://localhost:9000/callback
    &scope=read
    &state=random_state_string
  ```

- [ ] ä½¿ç”¨ Postman æˆ– curl è·å– Access Token
  ```bash
  curl -X POST http://localhost:8000/api/login/oauth/access_token \
    -H "Content-Type: application/json" \
    -d '{
      "grant_type": "authorization_code",
      "client_id": "<your_client_id>",
      "client_secret": "<your_client_secret>",
      "code": "<authorization_code>",
      "redirect_uri": "http://localhost:9000/callback"
    }'
  ```

#### Day 3ï¼šOIDC åè®®å­¦ä¹ 
- [ ] ç†è§£ OIDC ä¸ OAuth2 çš„å…³ç³»
  - OIDC = OAuth2 + èº«ä»½è®¤è¯å±‚
  - ID Token çš„ä½œç”¨

**ä»£ç é˜…è¯»**ï¼š
1. [ ] `controllers/oidc_discovery.go` â†’ OIDC Discovery ç«¯ç‚¹
2. [ ] `object/oidc_discovery.go` â†’ OIDC å…ƒæ•°æ®

**å®è·µä»»åŠ¡**ï¼š
- [ ] è®¿é—® OIDC Discovery ç«¯ç‚¹
  ```bash
  curl http://localhost:8000/.well-known/openid-configuration
  ```
- [ ] åˆ†æè¿”å›çš„ JSON é…ç½®
  - `issuer`
  - `authorization_endpoint`
  - `token_endpoint`
  - `userinfo_endpoint`
  - `jwks_uri`

- [ ] è·å– JWKSï¼ˆJSON Web Key Setï¼‰
  ```bash
  curl http://localhost:8000/.well-known/jwks
  ```

#### Day 4ï¼šå®ç°ä¸€ä¸ª OAuth å®¢æˆ·ç«¯
**å®è·µä»»åŠ¡**ï¼šç¼–å†™ä¸€ä¸ªç®€å•çš„ OAuth å®¢æˆ·ç«¯åº”ç”¨

åˆ›å»ºæ–‡ä»¶ `oauth-client-demo/main.go`ï¼š
```go
package main

import (
    "fmt"
    "net/http"
    "io/ioutil"
)

const (
    clientID     = "your_client_id"
    clientSecret = "your_client_secret"
    redirectURI  = "http://localhost:9000/callback"
    authURL      = "http://localhost:8000/login/oauth/authorize"
    tokenURL     = "http://localhost:8000/api/login/oauth/access_token"
)

func main() {
    http.HandleFunc("/", handleHome)
    http.HandleFunc("/login", handleLogin)
    http.HandleFunc("/callback", handleCallback)
    
    fmt.Println("OAuth Client è¿è¡Œåœ¨ http://localhost:9000")
    http.ListenAndServe(":9000", nil)
}

func handleHome(w http.ResponseWriter, r *http.Request) {
    html := `<html><body>
        <h1>OAuth 2.0 æµ‹è¯•å®¢æˆ·ç«¯</h1>
        <a href="/login">ä½¿ç”¨ Casdoor ç™»å½•</a>
    </body></html>`
    w.Write([]byte(html))
}

func handleLogin(w http.ResponseWriter, r *http.Request) {
    // é‡å®šå‘åˆ°æˆæƒæœåŠ¡å™¨
    url := fmt.Sprintf("%s?client_id=%s&response_type=code&redirect_uri=%s&scope=read&state=xyz",
        authURL, clientID, redirectURI)
    http.Redirect(w, r, url, http.StatusFound)
}

func handleCallback(w http.ResponseWriter, r *http.Request) {
    code := r.URL.Query().Get("code")
    state := r.URL.Query().Get("state")
    
    // éªŒè¯ state é˜²æ­¢ CSRF
    if state != "xyz" {
        http.Error(w, "Invalid state", http.StatusBadRequest)
        return
    }
    
    // ç”¨ code æ¢å– access_token
    // TODO: å®ç° token è·å–é€»è¾‘
    
    fmt.Fprintf(w, "æˆæƒç : %s", code)
}
```

- [ ] è¿è¡Œå®¢æˆ·ç«¯åº”ç”¨å¹¶å®Œæˆå®Œæ•´æˆæƒæµç¨‹
- [ ] éªŒè¯èƒ½å¤Ÿè·å– Access Token å’Œ Refresh Token

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… èƒ½ç”¨è‡ªå·±çš„è¯è§£é‡Š OAuth2 æˆæƒç æ¨¡å¼çš„æµç¨‹
2. âœ… ç†è§£ Authorization Codeã€Access Tokenã€Refresh Token çš„åŒºåˆ«
3. âœ… èƒ½è®¿é—®å¹¶ç†è§£ OIDC Discovery è¿”å›çš„é…ç½®
4. âœ… æˆåŠŸå®ç°ä¸€ä¸ªç®€å•çš„ OAuth å®¢æˆ·ç«¯
5. âœ… èƒ½è§£é‡Š ID Token å’Œ Access Token çš„åŒºåˆ«

### è¾“å‡ºç‰©
- [ ] OAuth2 æµç¨‹å›¾ï¼ˆä¿å­˜åˆ° `mdoc/OAuth2-æµç¨‹.png`ï¼‰
- [ ] OAuth å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç ï¼ˆä¿å­˜åˆ° `mdoc/oauth-client-demo/`ï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 5ï¼šæƒé™ç³»ç»Ÿï¼ˆCasbinï¼‰

**ç›®æ ‡**ï¼šç†è§£åŸºäº Casbin çš„æƒé™æ§åˆ¶å®ç°

**æ—¶é—´**ï¼š3å¤©

### ä»»åŠ¡æ¸…å•

#### Day 1ï¼šCasbin åŸºç¡€å­¦ä¹ 
- [ ] é˜…è¯» Casbin å®˜æ–¹æ–‡æ¡£
  - RBAC æ¨¡å‹
  - PERM å…ƒæ¨¡å‹
  - ç­–ç•¥ï¼ˆPolicyï¼‰å’Œæ¨¡å‹ï¼ˆModelï¼‰

**å®è·µä»»åŠ¡**ï¼š
- [ ] åœ¨æœ¬åœ°åˆ›å»º Casbin æµ‹è¯•é¡¹ç›®
  ```go
  package main
  
  import (
      "fmt"
      "github.com/casbin/casbin/v2"
  )
  
  func main() {
      e, _ := casbin.NewEnforcer("model.conf", "policy.csv")
      
      // æµ‹è¯•æƒé™
      sub := "alice"  // ç”¨æˆ·
      obj := "data1"  // èµ„æº
      act := "read"   // æ“ä½œ
      
      ok, _ := e.Enforce(sub, obj, act)
      if ok {
          fmt.Println("å…è®¸è®¿é—®")
      } else {
          fmt.Println("æ‹’ç»è®¿é—®")
      }
  }
  ```

åˆ›å»º `model.conf`ï¼š
```ini
[request_definition]
r = sub, obj, act

[policy_definition]
p = sub, obj, act

[role_definition]
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
m = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act
```

åˆ›å»º `policy.csv`ï¼š
```csv
p, alice, data1, read
p, bob, data2, write
p, data_admin, data1, read
p, data_admin, data1, write
g, alice, data_admin
```

- [ ] æµ‹è¯•æ·»åŠ ç­–ç•¥ã€åˆ é™¤ç­–ç•¥ã€æŸ¥è¯¢æƒé™

#### Day 2ï¼šCasdoor æƒé™æ¨¡å‹åˆ†æ
**ä»£ç é˜…è¯»**ï¼š
1. [ ] `authz/authz.go` - æƒé™åˆå§‹åŒ–å’Œæ‰§è¡Œ
2. [ ] `object/permission.go` - æƒé™å®šä¹‰
3. [ ] `object/role.go` - è§’è‰²å®šä¹‰
4. [ ] `object/enforcer.go` - Enforcer ç®¡ç†
5. [ ] `object/permission_enforcer.go` - æƒé™æ‰§è¡Œå™¨

**å®è·µä»»åŠ¡**ï¼š
- [ ] åœ¨ Casdoor ç®¡ç†ç•Œé¢åˆ›å»ºæƒé™é…ç½®
  1. åˆ›å»ºä¸€ä¸ªè§’è‰²ï¼š`editor`
  2. åˆ›å»ºä¸€ä¸ªæƒé™ï¼šå…è®¸ `editor` è®¿é—® `/api/get-users`
  3. å°†ç”¨æˆ·åˆ†é…åˆ°è§’è‰²

- [ ] åœ¨ä»£ç ä¸­æŸ¥çœ‹æƒé™å¦‚ä½•å­˜å‚¨
  ```sql
  SELECT * FROM permission;
  SELECT * FROM role;
  SELECT * FROM casbin_rule;
  ```

#### Day 3ï¼šæƒé™æ£€æŸ¥æµç¨‹å®è·µ
**ä»£ç é˜…è¯»**ï¼š
- [ ] `routers/authz_filter.go` - æƒé™è¿‡æ»¤å™¨
- [ ] `controllers/base.go` - åŸºç¡€æ§åˆ¶å™¨ï¼ˆæƒé™æ£€æŸ¥ï¼‰

**å®è·µä»»åŠ¡**ï¼š
- [ ] ä¸º API ç«¯ç‚¹æ·»åŠ æƒé™æ£€æŸ¥
  ```go
  // åœ¨ controllers/user.go ä¸­
  func (c *ApiController) GetUsers() {
      // æ£€æŸ¥æƒé™
      ok := object.CheckPermission(user, resource, action)
      if !ok {
          c.ResponseError("æ— æƒé™è®¿é—®")
          return
      }
      // ... ä¸šåŠ¡é€»è¾‘
  }
  ```

- [ ] æµ‹è¯•æƒé™æ‹’ç»åœºæ™¯
  1. åˆ›å»ºæ™®é€šç”¨æˆ·ï¼ˆæ— ç®¡ç†å‘˜æƒé™ï¼‰
  2. å°è¯•è®¿é—®ç®¡ç†æ¥å£
  3. éªŒè¯è¿”å› 403 Forbidden

- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
  ```go
  func TestPermission(t *testing.T) {
      user := &object.User{Owner: "built-in", Name: "testuser"}
      ok := object.CheckPermission(user, "user", "read")
      assert.True(t, ok)
  }
  ```

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… ç†è§£ RBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰æ¦‚å¿µ
2. âœ… èƒ½å¤Ÿç‹¬ç«‹ç¼–å†™ Casbin ç­–ç•¥æ–‡ä»¶
3. âœ… ç†è§£ Casdoor ä¸­æƒé™ã€è§’è‰²ã€ç”¨æˆ·çš„å…³ç³»
4. âœ… èƒ½å¤Ÿåœ¨ç•Œé¢é…ç½®è§’è‰²å’Œæƒé™
5. âœ… èƒ½å¤Ÿåœ¨ä»£ç ä¸­æ·»åŠ æƒé™æ£€æŸ¥é€»è¾‘

### è¾“å‡ºç‰©
- [ ] Casbin æƒé™æ¨¡å‹è¯´æ˜ï¼ˆä¿å­˜åˆ° `mdoc/æƒé™æ¨¡å‹åˆ†æ.md`ï¼‰
- [ ] æƒé™é…ç½®ç¤ºä¾‹ï¼ˆæˆªå›¾ä¿å­˜åˆ° `mdoc/permission-config.png`ï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 6ï¼šç¬¬ä¸‰æ–¹ç™»å½•é›†æˆ

**ç›®æ ‡**ï¼šç†è§£å¹¶å®ç°ç¬¬ä¸‰æ–¹ OAuth ç™»å½•ï¼ˆä»¥ GitHub ä¸ºä¾‹ï¼‰

**æ—¶é—´**ï¼š3å¤©

### ä»»åŠ¡æ¸…å•

#### Day 1ï¼šç¬¬ä¸‰æ–¹ç™»å½•åŸç†
**ä»£ç é˜…è¯»**ï¼š
1. [ ] `idp/provider.go` - Provider æ¥å£å®šä¹‰
2. [ ] `idp/github.go` - GitHub ç™»å½•å®ç°
3. [ ] `idp/goth.go` - Goth åº“å°è£…

**å®è·µä»»åŠ¡**ï¼š
- [ ] åœ¨ GitHub åˆ›å»º OAuth App
  1. è®¿é—® https://github.com/settings/developers
  2. ç‚¹å‡» "New OAuth App"
  3. å¡«å†™ä¿¡æ¯ï¼š
     - Application name: `Casdoor Test`
     - Homepage URL: `http://localhost:8000`
     - Callback URL: `http://localhost:8000/api/callback`
  4. è·å– Client ID å’Œ Client Secret

#### Day 2ï¼šé…ç½® GitHub ç™»å½•
**å®è·µä»»åŠ¡**ï¼š
- [ ] åœ¨ Casdoor ç®¡ç†ç•Œé¢åˆ›å»º Provider
  1. è¿›å…¥ "Providers" é¡µé¢
  2. ç‚¹å‡» "Add"
  3. é…ç½®ï¼š
     - Category: `OAuth`
     - Type: `GitHub`
     - Client ID: `<your_client_id>`
     - Client Secret: `<your_client_secret>`
  4. ä¿å­˜

- [ ] åœ¨ Application ä¸­å¯ç”¨ GitHub Provider
  1. ç¼–è¾‘åº”ç”¨
  2. åœ¨ "Providers" éƒ¨åˆ†æ·»åŠ åˆšåˆ›å»ºçš„ GitHub Provider
  3. ä¿å­˜

- [ ] æµ‹è¯• GitHub ç™»å½•
  1. é€€å‡ºç™»å½•
  2. åœ¨ç™»å½•é¡µé¢ç‚¹å‡» GitHub å›¾æ ‡
  3. å®Œæˆ OAuth æˆæƒ
  4. éªŒè¯è‡ªåŠ¨åˆ›å»ºç”¨æˆ·

#### Day 3ï¼šå®ç°è‡ªå®šä¹‰ Provider
**å®è·µä»»åŠ¡**ï¼šä¸ºä¸€ä¸ªæ–°çš„ OAuth æä¾›å•†ï¼ˆå¦‚ GitLabï¼‰æ·»åŠ æ”¯æŒ

åˆ›å»ºæ–‡ä»¶ `idp/gitlab.go`ï¼š
```go
package idp

import (
    "encoding/json"
    "fmt"
    "io/ioutil"
    "net/http"
    
    "golang.org/x/oauth2"
)

type GitLabIdProvider struct {
    Client *http.Client
    Config *oauth2.Config
}

func NewGitLabIdProvider(clientId string, clientSecret string, redirectUrl string) *GitLabIdProvider {
    idp := &GitLabIdProvider{}
    
    config := &oauth2.Config{
        ClientID:     clientId,
        ClientSecret: clientSecret,
        RedirectURL:  redirectUrl,
        Scopes:       []string{"read_user"},
        Endpoint: oauth2.Endpoint{
            AuthURL:  "https://gitlab.com/oauth/authorize",
            TokenURL: "https://gitlab.com/oauth/token",
        },
    }
    
    idp.Config = config
    return idp
}

func (idp *GitLabIdProvider) GetToken(code string) (*oauth2.Token, error) {
    return idp.Config.Exchange(oauth2.NoContext, code)
}

func (idp *GitLabIdProvider) GetUserInfo(token *oauth2.Token) (*UserInfo, error) {
    client := idp.Config.Client(oauth2.NoContext, token)
    response, err := client.Get("https://gitlab.com/api/v4/user")
    if err != nil {
        return nil, err
    }
    defer response.Body.Close()
    
    body, err := ioutil.ReadAll(response.Body)
    if err != nil {
        return nil, err
    }
    
    var gitlabUser struct {
        ID       int    `json:"id"`
        Username string `json:"username"`
        Name     string `json:"name"`
        Email    string `json:"email"`
        Avatar   string `json:"avatar_url"`
    }
    
    err = json.Unmarshal(body, &gitlabUser)
    if err != nil {
        return nil, err
    }
    
    userInfo := &UserInfo{
        Id:          fmt.Sprintf("%d", gitlabUser.ID),
        Username:    gitlabUser.Username,
        DisplayName: gitlabUser.Name,
        Email:       gitlabUser.Email,
        AvatarUrl:   gitlabUser.Avatar,
    }
    
    return userInfo, nil
}
```

- [ ] åœ¨ `idp/provider.go` ä¸­æ³¨å†Œ GitLab Provider
- [ ] æµ‹è¯• GitLab ç™»å½•åŠŸèƒ½

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… ç†è§£ç¬¬ä¸‰æ–¹ OAuth ç™»å½•çš„å®Œæ•´æµç¨‹
2. âœ… æˆåŠŸé…ç½®å¹¶æµ‹è¯• GitHub ç™»å½•
3. âœ… ç†è§£ç”¨æˆ·ä¿¡æ¯å¦‚ä½•ä»ç¬¬ä¸‰æ–¹åŒæ­¥åˆ° Casdoor
4. âœ… èƒ½å¤Ÿæ·»åŠ ä¸€ä¸ªæ–°çš„ç¬¬ä¸‰æ–¹ç™»å½•æä¾›å•†
5. âœ… ç†è§£ `markbates/goth` åº“çš„ä½œç”¨

### è¾“å‡ºç‰©
- [ ] ç¬¬ä¸‰æ–¹ç™»å½•æµç¨‹å›¾ï¼ˆä¿å­˜åˆ° `mdoc/ç¬¬ä¸‰æ–¹ç™»å½•æµç¨‹.png`ï¼‰
- [ ] è‡ªå®šä¹‰ Provider å®ç°ä»£ç ï¼ˆå¦‚æœå®Œæˆï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 7ï¼šå‰ç«¯æ¶æ„å­¦ä¹ 

**ç›®æ ‡**ï¼šç†è§£ React å‰ç«¯çš„æ¶æ„å’Œæ ¸å¿ƒåŠŸèƒ½

**æ—¶é—´**ï¼š3å¤©

### ä»»åŠ¡æ¸…å•

#### Day 1ï¼šå‰ç«¯é¡¹ç›®ç»“æ„åˆ†æ
- [ ] æŸ¥çœ‹ `web/package.json` äº†è§£ä¾èµ–
  - React ç‰ˆæœ¬
  - Ant Design ç‰ˆæœ¬
  - è·¯ç”±åº“ï¼ˆreact-router-domï¼‰
  - å›½é™…åŒ–ï¼ˆi18nextï¼‰

**ç›®å½•ç»“æ„å­¦ä¹ **ï¼š
```
web/
â”œâ”€â”€ public/          # é™æ€èµ„æº
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ auth/        # è®¤è¯ç›¸å…³é¡µé¢
â”‚   â”œâ”€â”€ backend/     # API è°ƒç”¨å°è£…
â”‚   â”œâ”€â”€ components/  # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ locales/     # å¤šè¯­è¨€æ–‡ä»¶
â”‚   â”œâ”€â”€ App.js       # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â””â”€â”€ index.js     # å…¥å£æ–‡ä»¶
â””â”€â”€ package.json
```

- [ ] é˜…è¯» `web/src/App.js`
- [ ] ç†è§£è·¯ç”±é…ç½®
  ```javascript
  <Route path="/login" element={<LoginPage />} />
  <Route path="/users" element={<UserListPage />} />
  // ... å…¶ä»–è·¯ç”±
  ```

#### Day 2ï¼šæ ¸å¿ƒé¡µé¢åˆ†æ
**å®è·µä»»åŠ¡**ï¼š
- [ ] ç™»å½•é¡µé¢ï¼š`web/src/auth/LoginPage.js`
  - ç†è§£è¡¨å•æäº¤é€»è¾‘
  - æŸ¥çœ‹ API è°ƒç”¨æ–¹å¼
  - ç†è§£ Token å­˜å‚¨ï¼ˆlocalStorageï¼‰

- [ ] ç”¨æˆ·ç®¡ç†é¡µé¢ï¼š`web/src/UserListPage.js`
  - Ant Design Table ç»„ä»¶ä½¿ç”¨
  - åˆ†é¡µã€æœç´¢ã€è¿‡æ»¤åŠŸèƒ½
  - CRUD æ“ä½œå®ç°

- [ ] ç”¨æˆ·ç¼–è¾‘é¡µé¢ï¼š`web/src/UserEditPage.js`
  - è¡¨å•éªŒè¯
  - å›¾ç‰‡ä¸Šä¼ 
  - æ•°æ®æäº¤

**ä»£ç é˜…è¯»é‡ç‚¹**ï¼š
```javascript
// API è°ƒç”¨ç¤ºä¾‹
import * as UserBackend from './backend/UserBackend';

// è·å–ç”¨æˆ·åˆ—è¡¨
UserBackend.getUsers("built-in")
  .then(res => {
    this.setState({users: res.data});
  });

// æ›´æ–°ç”¨æˆ·
UserBackend.updateUser(user)
  .then(res => {
    if (res.status === "ok") {
      // æˆåŠŸæç¤º
    }
  });
```

#### Day 3ï¼šå‰åç«¯äº¤äº’ä¸çŠ¶æ€ç®¡ç†
**å®è·µä»»åŠ¡**ï¼š
- [ ] æŸ¥çœ‹ `web/src/backend/` ç›®å½•
  - `UserBackend.js` - ç”¨æˆ·ç›¸å…³ API
  - `ApplicationBackend.js` - åº”ç”¨ç›¸å…³ API
  - `AuthBackend.js` - è®¤è¯ç›¸å…³ API

- [ ] ç†è§£ API è¯·æ±‚å°è£…
  ```javascript
  export function getUsers(owner) {
    return fetch(`${Setting.ServerUrl}/api/get-users?owner=${owner}`, {
      method: "GET",
      credentials: "include",  // æºå¸¦ Cookie
    }).then(res => res.json());
  }
  ```

- [ ] å­¦ä¹ è®¤è¯çŠ¶æ€ç®¡ç†
  - Token å­˜å‚¨ä½ç½®
  - ç™»å½•çŠ¶æ€æ£€æŸ¥
  - è‡ªåŠ¨è·³è½¬é€»è¾‘

**ä¿®æ”¹å®è·µ**ï¼š
- [ ] åœ¨ç”¨æˆ·åˆ—è¡¨é¡µé¢æ·»åŠ ä¸€ä¸ªæ–°åˆ—
- [ ] ä¿®æ”¹ç™»å½•é¡µé¢çš„æ ·å¼
- [ ] æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰æç¤ºæ¶ˆæ¯

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… ç†è§£ React é¡¹ç›®çš„ç›®å½•ç»“æ„
2. âœ… èƒ½å¤Ÿç‹¬ç«‹ä¿®æ”¹ä¸€ä¸ªé¡µé¢çš„æ ·å¼å’Œå¸ƒå±€
3. âœ… ç†è§£å‰åç«¯ API äº¤äº’æ–¹å¼
4. âœ… èƒ½å¤Ÿæ·»åŠ ä¸€ä¸ªæ–°çš„è¡¨å•å­—æ®µå¹¶ä¿å­˜åˆ°åç«¯
5. âœ… ç†è§£å¤šè¯­è¨€å›½é™…åŒ–çš„å®ç°æ–¹å¼

### è¾“å‡ºç‰©
- [ ] å‰ç«¯æ¶æ„è¯´æ˜æ–‡æ¡£ï¼ˆä¿å­˜åˆ° `mdoc/å‰ç«¯æ¶æ„.md`ï¼‰
- [ ] é¡µé¢ä¿®æ”¹ç¤ºä¾‹ä»£ç ï¼ˆæˆªå›¾ï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 8ï¼šé«˜çº§åŠŸèƒ½æ¨¡å—

**ç›®æ ‡**ï¼šæŒæ¡ MFAã€SAMLã€LDAP ç­‰é«˜çº§åŠŸèƒ½

**æ—¶é—´**ï¼š4å¤©

### ä»»åŠ¡æ¸…å•

#### Day 1ï¼šå¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰
**ä»£ç é˜…è¯»**ï¼š
1. [ ] `object/mfa.go` - MFA æ ¸å¿ƒé€»è¾‘
2. [ ] `object/mfa_totp.go` - TOTP å®ç°
3. [ ] `controllers/mfa.go` - MFA API

**å®è·µä»»åŠ¡**ï¼š
- [ ] ä¸ºæµ‹è¯•ç”¨æˆ·å¯ç”¨ TOTP MFA
  1. ç™»å½•æµ‹è¯•ç”¨æˆ·
  2. è¿›å…¥ä¸ªäººè®¾ç½®
  3. å¯ç”¨ MFA
  4. ä½¿ç”¨ Google Authenticator æ‰«æäºŒç»´ç 
  5. è¾“å…¥éªŒè¯ç å®Œæˆç»‘å®š

- [ ] æµ‹è¯• MFA ç™»å½•æµç¨‹
  1. é€€å‡ºç™»å½•
  2. ä½¿ç”¨ç”¨æˆ·åå¯†ç ç™»å½•
  3. è¾“å…¥ MFA éªŒè¯ç 
  4. æˆåŠŸè¿›å…¥ç³»ç»Ÿ

- [ ] æŸ¥çœ‹ TOTP ç”Ÿæˆé€»è¾‘
  ```go
  // pquerna/otp åº“çš„ä½¿ç”¨
  key, _ := totp.Generate(totp.GenerateOpts{
      Issuer:      "Casdoor",
      AccountName: user.Name,
  })
  ```

#### Day 2ï¼šSAML åè®®
**ç†è®ºå­¦ä¹ **ï¼š
- [ ] é˜…è¯» SAML 2.0 åŸºç¡€çŸ¥è¯†
  - SPï¼ˆService Providerï¼‰
  - IdPï¼ˆIdentity Providerï¼‰
  - SSO æµç¨‹

**ä»£ç é˜…è¯»**ï¼š
1. [ ] `controllers/saml.go`
2. [ ] `object/saml_sp.go` - SP å®ç°
3. [ ] `object/saml_idp.go` - IdP å®ç°

**å®è·µä»»åŠ¡**ï¼š
- [ ] é…ç½® Casdoor ä½œä¸º SAML IdP
  1. åˆ›å»ºä¸€ä¸ªæ”¯æŒ SAML çš„åº”ç”¨
  2. é…ç½® SAML ç›¸å…³å‚æ•°
  3. ä¸‹è½½ SAML å…ƒæ•°æ®
     ```bash
     curl http://localhost:8000/api/saml/metadata > metadata.xml
     ```

- [ ] ä½¿ç”¨ SAML æµ‹è¯•å·¥å…·éªŒè¯
  - åœ¨çº¿å·¥å…·ï¼šhttps://www.samltool.com/

#### Day 3ï¼šLDAP æœåŠ¡å™¨
**ä»£ç é˜…è¯»**ï¼š
1. [ ] `ldap/server.go` - LDAP æœåŠ¡å™¨å®ç°
2. [ ] `ldap/util.go` - LDAP å·¥å…·å‡½æ•°
3. [ ] `object/ldap.go` - LDAP ç”¨æˆ·åŒæ­¥

**å®è·µä»»åŠ¡**ï¼š
- [ ] å¯åŠ¨ LDAP æœåŠ¡å™¨ï¼ˆé»˜è®¤ç«¯å£ 389ï¼‰
- [ ] ä½¿ç”¨ LDAP å®¢æˆ·ç«¯æµ‹è¯•è¿æ¥
  ```bash
  # å®‰è£… ldapsearch
  brew install openldap  # macOS
  # apt-get install ldap-utils  # Ubuntu
  
  # æµ‹è¯•æŸ¥è¯¢
  ldapsearch -x -H ldap://localhost:389 \
    -D "cn=admin,dc=example,dc=com" \
    -w "123" \
    -b "ou=People,dc=example,dc=com"
  ```

- [ ] é…ç½® LDAP åŒæ­¥
  1. åˆ›å»º LDAP Syncer
  2. é…ç½®å¤–éƒ¨ LDAP æœåŠ¡å™¨è¿æ¥
  3. æ‰§è¡ŒåŒæ­¥ä»»åŠ¡

#### Day 4ï¼šWebhook å’Œé€šçŸ¥
**ä»£ç é˜…è¯»**ï¼š
1. [ ] `object/webhook.go` - Webhook ç®¡ç†
2. [ ] `notification/` ç›®å½• - å„ç§é€šçŸ¥æ¸ é“
   - `notification/email.go`
   - `notification/slack.go`
   - `notification/dingtalk.go`

**å®è·µä»»åŠ¡**ï¼š
- [ ] åˆ›å»º Webhook
  1. åœ¨ç®¡ç†ç•Œé¢åˆ›å»º Webhook
  2. é…ç½®è§¦å‘äº‹ä»¶ï¼ˆå¦‚ç”¨æˆ·æ³¨å†Œï¼‰
  3. è®¾ç½®å›è°ƒ URL

- [ ] æ­å»ºæµ‹è¯•æœåŠ¡å™¨æ¥æ”¶ Webhook
  ```go
  package main
  
  import (
      "fmt"
      "io/ioutil"
      "net/http"
  )
  
  func main() {
      http.HandleFunc("/webhook", func(w http.ResponseWriter, r *http.Request) {
          body, _ := ioutil.ReadAll(r.Body)
          fmt.Printf("æ”¶åˆ° Webhook: %s\n", string(body))
          w.WriteHeader(200)
      })
      
      http.ListenAndServe(":9000", nil)
  }
  ```

- [ ] è§¦å‘äº‹ä»¶å¹¶éªŒè¯ Webhook è°ƒç”¨

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… æˆåŠŸé…ç½®å¹¶æµ‹è¯• TOTP MFA
2. âœ… ç†è§£ SAML SSO çš„åŸºæœ¬æµç¨‹
3. âœ… èƒ½å¤Ÿé€šè¿‡ LDAP åè®®è®¿é—® Casdoor ç”¨æˆ·
4. âœ… æˆåŠŸé…ç½®å¹¶æ¥æ”¶ Webhook é€šçŸ¥
5. âœ… ç†è§£å„åŠŸèƒ½æ¨¡å—çš„åº”ç”¨åœºæ™¯

### è¾“å‡ºç‰©
- [ ] MFA é…ç½®æŒ‡å—ï¼ˆä¿å­˜åˆ° `mdoc/MFAé…ç½®æŒ‡å—.md`ï¼‰
- [ ] LDAP æµ‹è¯•æŠ¥å‘Šï¼ˆä¿å­˜åˆ° `mdoc/LDAPæµ‹è¯•.md`ï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘ 9ï¼šå®æˆ˜é¡¹ç›®å¼€å‘

**ç›®æ ‡**ï¼šç‹¬ç«‹å¼€å‘ä¸€ä¸ªå®Œæ•´åŠŸèƒ½æ¨¡å—

**æ—¶é—´**ï¼š5å¤©

### é¡¹ç›®é€‰æ‹©ï¼ˆä¸‰é€‰ä¸€ï¼‰

#### é¡¹ç›® Aï¼šè‡ªå®šä¹‰ç™»å½•é¡µé¢ä¸»é¢˜
**éœ€æ±‚**ï¼š
- æ”¯æŒç®¡ç†å‘˜è‡ªå®šä¹‰ç™»å½•é¡µé¢
- å¯é…ç½® Logoã€èƒŒæ™¯å›¾ã€ä¸»é¢˜è‰²
- é¢„è§ˆåŠŸèƒ½

**æŠ€æœ¯è¦ç‚¹**ï¼š
- å‰ç«¯ï¼šReact ç»„ä»¶å¼€å‘
- åç«¯ï¼šé…ç½®å­˜å‚¨å’Œè¯»å–
- æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

#### é¡¹ç›® Bï¼šç”¨æˆ·è¡Œä¸ºå®¡è®¡æ—¥å¿—
**éœ€æ±‚**ï¼š
- è®°å½•æ‰€æœ‰ç”¨æˆ·æ“ä½œï¼ˆç™»å½•ã€ä¿®æ”¹èµ„æ–™ç­‰ï¼‰
- å®¡è®¡æ—¥å¿—æŸ¥è¯¢å’Œå¯¼å‡º
- æ•æ„Ÿæ“ä½œå‘Šè­¦

**æŠ€æœ¯è¦ç‚¹**ï¼š
- ä¸­é—´ä»¶å¼€å‘
- æ•°æ®åº“è®¾è®¡
- æ—¥å¿—æŸ¥è¯¢ä¼˜åŒ–

#### é¡¹ç›® Cï¼šAPI è®¿é—®é¢‘ç‡é™åˆ¶
**éœ€æ±‚**ï¼š
- å¯¹ API è¿›è¡Œé¢‘ç‡é™åˆ¶
- æ”¯æŒæŒ‰ç”¨æˆ·ã€IP é™åˆ¶
- é™åˆ¶è§„åˆ™å¯é…ç½®

**æŠ€æœ¯è¦ç‚¹**ï¼š
- ä¸­é—´ä»¶å¼€å‘
- Redis ç¼“å­˜
- é™æµç®—æ³•ï¼ˆä»¤ç‰Œæ¡¶/æ¼æ¡¶ï¼‰

### å¼€å‘æ­¥éª¤

#### Day 1ï¼šéœ€æ±‚åˆ†æå’Œè®¾è®¡
- [ ] ç¼–å†™éœ€æ±‚æ–‡æ¡£
- [ ] è®¾è®¡æ•°æ®åº“è¡¨ç»“æ„ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] è®¾è®¡ API æ¥å£
- [ ] ç»˜åˆ¶åŠŸèƒ½æµç¨‹å›¾

#### Day 2-3ï¼šåç«¯å¼€å‘
- [ ] åˆ›å»ºæ•°æ®æ¨¡å‹
- [ ] å®ç°ä¸šåŠ¡é€»è¾‘
- [ ] æ·»åŠ  API ç«¯ç‚¹
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•

#### Day 4ï¼šå‰ç«¯å¼€å‘
- [ ] åˆ›å»ºç®¡ç†é¡µé¢
- [ ] å®ç°è¡¨å•å’Œåˆ—è¡¨
- [ ] å¯¹æ¥åç«¯ API
- [ ] æ ·å¼ä¼˜åŒ–

#### Day 5ï¼šæµ‹è¯•å’Œæ–‡æ¡£
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] Bug ä¿®å¤
- [ ] ç¼–å†™ä½¿ç”¨æ–‡æ¡£
- [ ] ä»£ç æ³¨é‡Šå®Œå–„

### éªŒæ”¶æ ‡å‡† âœ…

1. âœ… åŠŸèƒ½å®Œæ•´å¯ç”¨
2. âœ… ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ
3. âœ… æœ‰å•å…ƒæµ‹è¯•è¦†ç›–
4. âœ… æœ‰å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£
5. âœ… æ— æ˜æ˜¾ Bug

### è¾“å‡ºç‰©
- [ ] åŠŸèƒ½è®¾è®¡æ–‡æ¡£ï¼ˆä¿å­˜åˆ° `mdoc/å®æˆ˜é¡¹ç›®-è®¾è®¡.md`ï¼‰
- [ ] æºä»£ç ï¼ˆæäº¤åˆ° Git åˆ†æ”¯ï¼‰
- [ ] ä½¿ç”¨æ–‡æ¡£ï¼ˆä¿å­˜åˆ° `mdoc/å®æˆ˜é¡¹ç›®-ä½¿ç”¨æ‰‹å†Œ.md`ï¼‰
- [ ] æ¼”ç¤ºè§†é¢‘æˆ–æˆªå›¾

---

## ğŸ“Š å­¦ä¹ è¯„ä¼°ä¸æ€»ç»“

### æœ€ç»ˆæ£€éªŒæ¸…å•

#### ç†è®ºçŸ¥è¯†
- [ ] èƒ½è§£é‡Š OAuth2 å’Œ OIDC çš„åŒºåˆ«
- [ ] èƒ½è¯´æ˜ JWT çš„ç»„æˆå’ŒéªŒè¯æµç¨‹
- [ ] ç†è§£ RBAC æƒé™æ¨¡å‹
- [ ] äº†è§£ SAMLã€CASã€LDAP åè®®

#### å®è·µèƒ½åŠ›
- [ ] èƒ½ç‹¬ç«‹éƒ¨ç½² Casdoor
- [ ] èƒ½ä¸ºæ–°åº”ç”¨æ¥å…¥ Casdoor è®¤è¯
- [ ] èƒ½é…ç½®ç¬¬ä¸‰æ–¹ç™»å½•
- [ ] èƒ½æ·»åŠ æ–°çš„åŠŸèƒ½æ¨¡å—

#### ä»£ç èƒ½åŠ›
- [ ] èƒ½è¯»æ‡‚ Casdoor æ ¸å¿ƒä»£ç 
- [ ] èƒ½ä¿®æ”¹å’Œæ‰©å±•åŠŸèƒ½
- [ ] èƒ½ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- [ ] èƒ½è§£å†³å¸¸è§é—®é¢˜

### é¡¹ç›®æ€»ç»“æŠ¥å‘Š

å®Œæˆæ‰€æœ‰é‡Œç¨‹ç¢‘åï¼Œç¼–å†™ä¸€ä»½æ€»ç»“æŠ¥å‘Šï¼š

**ä¿å­˜åˆ° `mdoc/å­¦ä¹ æ€»ç»“æŠ¥å‘Š.md`**

å†…å®¹åŒ…æ‹¬ï¼š
1. å­¦ä¹ è·¯å¾„å›é¡¾
2. é‡åˆ°çš„ä¸»è¦é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
3. æ ¸å¿ƒæŠ€æœ¯ç†è§£
4. å®æˆ˜é¡¹ç›®å±•ç¤º
5. åç»­å­¦ä¹ è®¡åˆ’

---

## ğŸ”— å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- Casdoor æ–‡æ¡£ï¼šhttps://casdoor.org
- Casbin æ–‡æ¡£ï¼šhttps://casbin.org
- Beego æ–‡æ¡£ï¼šhttps://beego.wiki

### åè®®è§„èŒƒ
- OAuth 2.0 RFC6749ï¼šhttps://tools.ietf.org/html/rfc6749
- OpenID Connectï¼šhttps://openid.net/connect/
- SAML 2.0ï¼šhttp://docs.oasis-open.org/security/saml/

### å­¦ä¹ èµ„æº
- OAuth 2.0 Playgroundï¼šhttps://www.oauth.com/playground/
- JWT.ioï¼šhttps://jwt.io
- SAML Toolï¼šhttps://www.samltool.com

### ç¤¾åŒº
- GitHub Issuesï¼šhttps://github.com/casdoor/casdoor/issues
- Discordï¼šhttps://discord.gg/5rPsrAzK7S

---

## ğŸ“ æ¯æ—¥å­¦ä¹ è®°å½•æ¨¡æ¿

åœ¨ `mdoc/` ç›®å½•ä¸‹åˆ›å»ºæ—¥å¿—æ–‡ä»¶è®°å½•å­¦ä¹ è¿›åº¦ï¼š

**æ–‡ä»¶å**ï¼š`å­¦ä¹ æ—¥å¿—-YYYY-MM-DD.md`

```markdown
# å­¦ä¹ æ—¥å¿— - YYYY-MM-DD

## ä»Šæ—¥ç›®æ ‡
- [ ] ç›®æ ‡1
- [ ] ç›®æ ‡2

## å­¦ä¹ å†…å®¹
### ä¸Šåˆ
- é˜…è¯»çš„ä»£ç æ–‡ä»¶ï¼š
- å…³é”®å‘ç°ï¼š

### ä¸‹åˆ
- å®è·µçš„ä»»åŠ¡ï¼š
- é‡åˆ°çš„é—®é¢˜ï¼š

## ä»£ç ç¬”è®°
\`\`\`go
// å…³é”®ä»£ç ç‰‡æ®µ
\`\`\`

## é—®é¢˜è®°å½•
1. é—®é¢˜æè¿°ï¼š
   è§£å†³æ–¹æ¡ˆï¼š

## æ˜å¤©è®¡åˆ’
- 
```

---

## ğŸ‰ ç»“è¯­

è¿™ä»½å­¦ä¹ è®¡åˆ’æ˜¯ä¸€ä¸ªæŒ‡å¯¼æ¡†æ¶ï¼Œè¯·æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µçµæ´»è°ƒæ•´ï¼š

- â° **æ—¶é—´å®‰æ’**ï¼šå¯ä»¥åŠ å¿«æˆ–æ”¾æ…¢èŠ‚å¥
- ğŸ“š **æ·±åº¦é€‰æ‹©**ï¼šæŸäº›æ¨¡å—å¯ä»¥è·³è¿‡æˆ–æ·±å…¥
- ğŸ¯ **é¡¹ç›®é€‰æ‹©**ï¼šæ ¹æ®å…´è¶£é€‰æ‹©å®æˆ˜é¡¹ç›®
- ğŸ”„ **è¿­ä»£å­¦ä¹ **ï¼šé‡åˆ°éš¾ç‚¹å¯ä»¥å›å¤´å¤ä¹ 

**è®°ä½**ï¼šå­¦ä¹ æºç æœ€é‡è¦çš„æ˜¯ï¼š
1. **åŠ¨æ‰‹å®è·µ** - ä¸è¦åªçœ‹ä»£ç ï¼Œè¦è¿è¡Œå’Œè°ƒè¯•
2. **åšå¥½ç¬”è®°** - è®°å½•å…³é”®ç†è§£å’Œé—®é¢˜
3. **æå‡ºé—®é¢˜** - ä¸æ‡‚å°±é—®ï¼Œå‚ä¸ç¤¾åŒºè®¨è®º
4. **æŒç»­å­¦ä¹ ** - æŠ€æœ¯åœ¨å‘å±•ï¼Œä¿æŒå­¦ä¹ çƒ­æƒ…

ç¥å­¦ä¹ é¡ºåˆ©ï¼ğŸš€

